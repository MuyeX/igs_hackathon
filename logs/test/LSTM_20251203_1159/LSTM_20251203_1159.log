2025-12-03 11:59:28,049 - INFO - ========== Configuration ==========
2025-12-03 11:59:28,049 - INFO - data_path: ['./datasets/simglucose/Simulation_OpenAPS_testing_all_faults/']
2025-12-03 11:59:28,049 - INFO - model_path: ./logs/train/LSTM_20251203_1145/model.pt
2025-12-03 11:59:28,049 - INFO - mode: test
2025-12-03 11:59:28,049 - INFO - testbed: simglucose
2025-12-03 11:59:28,049 - INFO - method: LSTM
2025-12-03 11:59:28,049 - INFO - log_dir: logs/
2025-12-03 11:59:28,049 - INFO - log_tag: 20251203_1159
2025-12-03 11:59:28,049 - INFO - tolerance_window: 48
2025-12-03 11:59:28,049 - INFO - batch_size: 64
2025-12-03 11:59:28,049 - INFO - bg_target: 140
2025-12-03 11:59:28,049 - INFO - window_size: 150
2025-12-03 11:59:28,049 - INFO - stride: 6
2025-12-03 11:59:28,049 - INFO - Selected device: mps
2025-12-03 11:59:28,049 - INFO - ===================================
2025-12-03 11:59:28,049 - INFO - Starting anomaly detection pipeline...
2025-12-03 11:59:28,049 - INFO - Reading data from: ['./datasets/simglucose/Simulation_OpenAPS_testing_all_faults/']
2025-12-03 11:59:28,050 - INFO - Running anomaly detection using LSTM...
2025-12-03 11:59:30,224 - INFO - Total 10 patient and each patient have 312 samples for testing.
2025-12-03 11:59:38,439 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 11:59:39,023 - INFO - 
Patient_0's Overall Evaluation Metrics:
  standard_f: 0.0000
  range_f: 0.0000
  affinity_f: 0.0000
  fault_to_hazard_reaction:
    detection_rate: 0.0000
    reaction_time (min): nan
  all_hazard_reaction:
    detection_rate: 0.0000
    reaction_time (min): nan

2025-12-03 11:59:39,023 - INFO - 
Patient_0's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0000
  Standard F-score - 95%CI: 0.0000
  Range F-score - Mean: 0.0000
  Range F-score - 95%CI: 0.0000
  Affinity F-score - Mean: 0.1859
  Affinity F-score - 95%CI: 0.0434
  Inference Latency (s):
    median: 0.0234
    q1: 0.0218
    q3: 0.0245
    p95: 0.0262
    min: 0.0202
    max: 0.3899
  Memory Footprint - Peak RAM (MB): 13.8594
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 11:59:46,692 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 11:59:47,294 - INFO - 
Patient_1's Overall Evaluation Metrics:
  standard_f: 0.0602
  range_f: 0.1818
  affinity_f: 0.1641
  fault_to_hazard_reaction:
    detection_rate: 0.0000
    reaction_time (min): nan
  all_hazard_reaction:
    detection_rate: 11.7647
    reaction_time (min): {'median': np.float64(177.5), 'q1': np.float64(176.25), 'q3': np.float64(178.75), 'p95': np.float64(179.75), 'min': np.float64(175.0), 'max': np.float64(180.0)}

2025-12-03 11:59:47,294 - INFO - 
Patient_1's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0030
  Standard F-score - 95%CI: 0.0051
  Range F-score - Mean: 0.0091
  Range F-score - 95%CI: 0.0092
  Affinity F-score - Mean: 0.2081
  Affinity F-score - 95%CI: 0.0437
  Inference Latency (s):
    median: 0.0231
    q1: 0.0216
    q3: 0.0242
    p95: 0.0252
    min: 0.0203
    max: 0.0263
  Memory Footprint - Peak RAM (MB): 0.0938
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 11:59:55,009 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 11:59:55,587 - INFO - 
Patient_2's Overall Evaluation Metrics:
  standard_f: 0.1284
  range_f: 0.2105
  affinity_f: 0.2438
  fault_to_hazard_reaction:
    detection_rate: 6.2500
    reaction_time (min): {'median': np.float64(30.0), 'q1': np.float64(30.0), 'q3': np.float64(30.0), 'p95': np.float64(30.0), 'min': np.float64(30.0), 'max': np.float64(30.0)}
  all_hazard_reaction:
    detection_rate: 14.2857
    reaction_time (min): {'median': np.float64(180.0), 'q1': np.float64(142.5), 'q3': np.float64(180.0), 'p95': np.float64(180.0), 'min': np.float64(30.0), 'max': np.float64(180.0)}

2025-12-03 11:59:55,587 - INFO - 
Patient_2's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0047
  Standard F-score - 95%CI: 0.0044
  Range F-score - Mean: 0.0130
  Range F-score - 95%CI: 0.0103
  Affinity F-score - Mean: 0.2104
  Affinity F-score - 95%CI: 0.0437
  Inference Latency (s):
    median: 0.0233
    q1: 0.0218
    q3: 0.0243
    p95: 0.0253
    min: 0.0204
    max: 0.0275
  Memory Footprint - Peak RAM (MB): 0.1406
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:03,409 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:03,982 - INFO - 
Patient_3's Overall Evaluation Metrics:
  standard_f: 0.1377
  range_f: 0.2000
  affinity_f: 0.2505
  fault_to_hazard_reaction:
    detection_rate: 21.4286
    reaction_time (min): {'median': np.float64(20.0), 'q1': np.float64(12.5), 'q3': np.float64(25.0), 'p95': np.float64(29.0), 'min': np.float64(5.0), 'max': np.float64(30.0)}
  all_hazard_reaction:
    detection_rate: 14.2857
    reaction_time (min): {'median': np.float64(180.0), 'q1': np.float64(140.0), 'q3': np.float64(180.0), 'p95': np.float64(180.0), 'min': np.float64(20.0), 'max': np.float64(180.0)}

2025-12-03 12:00:03,983 - INFO - 
Patient_3's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0080
  Standard F-score - 95%CI: 0.0066
  Range F-score - Mean: 0.0154
  Range F-score - 95%CI: 0.0115
  Affinity F-score - Mean: 0.2116
  Affinity F-score - 95%CI: 0.0439
  Inference Latency (s):
    median: 0.0231
    q1: 0.0213
    q3: 0.0241
    p95: 0.0256
    min: 0.0203
    max: 0.1389
  Memory Footprint - Peak RAM (MB): 0.0625
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:12,825 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:13,398 - INFO - 
Patient_4's Overall Evaluation Metrics:
  standard_f: 0.1511
  range_f: 0.1379
  affinity_f: 0.2366
  fault_to_hazard_reaction:
    detection_rate: 6.6667
    reaction_time (min): {'median': np.float64(135.0), 'q1': np.float64(135.0), 'q3': np.float64(135.0), 'p95': np.float64(135.0), 'min': np.float64(135.0), 'max': np.float64(135.0)}
  all_hazard_reaction:
    detection_rate: 14.2857
    reaction_time (min): {'median': np.float64(180.0), 'q1': np.float64(180.0), 'q3': np.float64(180.0), 'p95': np.float64(180.0), 'min': np.float64(180.0), 'max': np.float64(180.0)}

2025-12-03 12:00:13,398 - INFO - 
Patient_4's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0082
  Standard F-score - 95%CI: 0.0059
  Range F-score - Mean: 0.0170
  Range F-score - 95%CI: 0.0109
  Affinity F-score - Mean: 0.2210
  Affinity F-score - 95%CI: 0.0447
  Inference Latency (s):
    median: 0.0259
    q1: 0.0235
    q3: 0.0289
    p95: 0.0321
    min: 0.0207
    max: 0.0728
  Memory Footprint - Peak RAM (MB): 0.0469
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:21,157 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:21,741 - INFO - 
Patient_5's Overall Evaluation Metrics:
  standard_f: 0.0234
  range_f: 0.0952
  affinity_f: 0.1517
  fault_to_hazard_reaction:
    detection_rate: 7.6923
    reaction_time (min): {'median': np.float64(405.0), 'q1': np.float64(405.0), 'q3': np.float64(405.0), 'p95': np.float64(405.0), 'min': np.float64(405.0), 'max': np.float64(405.0)}
  all_hazard_reaction:
    detection_rate: 9.0909
    reaction_time (min): {'median': np.float64(177.5), 'q1': np.float64(176.25), 'q3': np.float64(178.75), 'p95': np.float64(179.75), 'min': np.float64(175.0), 'max': np.float64(180.0)}

2025-12-03 12:00:21,741 - INFO - 
Patient_5's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0013
  Standard F-score - 95%CI: 0.0025
  Range F-score - Mean: 0.0032
  Range F-score - 95%CI: 0.0063
  Affinity F-score - Mean: 0.2057
  Affinity F-score - 95%CI: 0.0436
  Inference Latency (s):
    median: 0.0232
    q1: 0.0214
    q3: 0.0241
    p95: 0.0273
    min: 0.0207
    max: 0.0312
  Memory Footprint - Peak RAM (MB): 0.0938
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:29,780 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:30,355 - INFO - 
Patient_6's Overall Evaluation Metrics:
  standard_f: 0.0000
  range_f: 0.0000
  affinity_f: 0.0000
  fault_to_hazard_reaction:
    detection_rate: 0.0000
    reaction_time (min): nan
  all_hazard_reaction:
    detection_rate: 0.0000
    reaction_time (min): nan

2025-12-03 12:00:30,355 - INFO - 
Patient_6's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0000
  Standard F-score - 95%CI: 0.0000
  Range F-score - Mean: 0.0000
  Range F-score - 95%CI: 0.0000
  Affinity F-score - Mean: 0.1859
  Affinity F-score - 95%CI: 0.0434
  Inference Latency (s):
    median: 0.0238
    q1: 0.0224
    q3: 0.0252
    p95: 0.0278
    min: 0.0205
    max: 0.0401
  Memory Footprint - Peak RAM (MB): 0.1094
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:37,893 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:38,466 - INFO - 
Patient_7's Overall Evaluation Metrics:
  standard_f: 0.0232
  range_f: 0.1600
  affinity_f: 0.1642
  fault_to_hazard_reaction:
    detection_rate: 9.0909
    reaction_time (min): {'median': np.float64(500.0), 'q1': np.float64(500.0), 'q3': np.float64(500.0), 'p95': np.float64(500.0), 'min': np.float64(500.0), 'max': np.float64(500.0)}
  all_hazard_reaction:
    detection_rate: 11.1111
    reaction_time (min): {'median': np.float64(180.0), 'q1': np.float64(180.0), 'q3': np.float64(180.0), 'p95': np.float64(180.0), 'min': np.float64(180.0), 'max': np.float64(180.0)}

2025-12-03 12:00:38,466 - INFO - 
Patient_7's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0013
  Standard F-score - 95%CI: 0.0025
  Range F-score - Mean: 0.0034
  Range F-score - 95%CI: 0.0040
  Affinity F-score - Mean: 0.2076
  Affinity F-score - 95%CI: 0.0437
  Inference Latency (s):
    median: 0.0226
    q1: 0.0210
    q3: 0.0237
    p95: 0.0250
    min: 0.0206
    max: 0.0283
  Memory Footprint - Peak RAM (MB): 8.6406
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:46,323 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:46,897 - INFO - 
Patient_8's Overall Evaluation Metrics:
  standard_f: 0.1295
  range_f: 0.1053
  affinity_f: 0.1584
  fault_to_hazard_reaction:
    detection_rate: 5.5556
    reaction_time (min): {'median': np.float64(60.0), 'q1': np.float64(60.0), 'q3': np.float64(60.0), 'p95': np.float64(60.0), 'min': np.float64(60.0), 'max': np.float64(60.0)}
  all_hazard_reaction:
    detection_rate: 11.1111
    reaction_time (min): {'median': np.float64(180.0), 'q1': np.float64(162.5), 'q3': np.float64(180.0), 'p95': np.float64(180.0), 'min': np.float64(145.0), 'max': np.float64(180.0)}

2025-12-03 12:00:46,897 - INFO - 
Patient_8's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0047
  Standard F-score - 95%CI: 0.0058
  Range F-score - Mean: 0.0128
  Range F-score - 95%CI: 0.0102
  Affinity F-score - Mean: 0.2131
  Affinity F-score - 95%CI: 0.0442
  Inference Latency (s):
    median: 0.0232
    q1: 0.0213
    q3: 0.0240
    p95: 0.0293
    min: 0.0207
    max: 0.0744
  Memory Footprint - Peak RAM (MB): 0.1406
  Memory Footprint - Peak GPU (MB): 0.0000

2025-12-03 12:00:54,366 - INFO - Stitching sliding window samples back to continuous time series using mode: max
2025-12-03 12:00:54,941 - INFO - 
Patient_9's Overall Evaluation Metrics:
  standard_f: 0.1835
  range_f: 0.2105
  affinity_f: 0.2377
  fault_to_hazard_reaction:
    detection_rate: 7.1429
    reaction_time (min): {'median': np.float64(135.0), 'q1': np.float64(135.0), 'q3': np.float64(135.0), 'p95': np.float64(135.0), 'min': np.float64(135.0), 'max': np.float64(135.0)}
  all_hazard_reaction:
    detection_rate: 16.0000
    reaction_time (min): {'median': np.float64(180.0), 'q1': np.float64(180.0), 'q3': np.float64(180.0), 'p95': np.float64(180.0), 'min': np.float64(180.0), 'max': np.float64(180.0)}

2025-12-03 12:00:54,941 - INFO - 
Patient_9's Sample-level Evaluation Metrics:
  Standard F-score - Mean: 0.0086
  Standard F-score - 95%CI: 0.0080
  Range F-score - Mean: 0.0208
  Range F-score - 95%CI: 0.0126
  Affinity F-score - Mean: 0.2168
  Affinity F-score - 95%CI: 0.0443
  Inference Latency (s):
    median: 0.0219
    q1: 0.0212
    q3: 0.0236
    p95: 0.0242
    min: 0.0202
    max: 0.0260
  Memory Footprint - Peak RAM (MB): 0.1094
  Memory Footprint - Peak GPU (MB): 0.0000

